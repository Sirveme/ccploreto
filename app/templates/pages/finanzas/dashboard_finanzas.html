<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Finanzas — CCPL ColegiosPro</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
  --navy:    #0d1b2a;
  --navy2:   #142333;
  --navy3:   #1c3048;
  --gold:    #c9a84c;
  --gold2:   #f0cc70;
  --verde:   #2ecc8f;
  --rojo:    #e05555;
  --naranja: #e8934a;
  --azul:    #4a9edd;
  --txt:     #e8edf2;
  --txt2:    #8fa3b8;
  --txt3:    #56728a;
  --borde:   rgba(201,168,76,0.15);
  --card:    rgba(20,35,51,0.8);
}

*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

body {
  font-family: 'DM Sans', sans-serif;
  background: var(--navy);
  color: var(--txt);
  min-height: 100vh;
  overflow-x: hidden;
}

/* ─ BACKGROUND TEXTURE ─ */
body::before {
  content:'';
  position:fixed; inset:0;
  background:
    radial-gradient(ellipse 80% 60% at 70% 20%, rgba(201,168,76,0.06) 0%, transparent 60%),
    radial-gradient(ellipse 50% 40% at 10% 80%, rgba(46,204,143,0.04) 0%, transparent 50%);
  pointer-events:none; z-index:0;
}

/* ─ SIDEBAR ─ */
.sidebar {
  position:fixed; left:0; top:0; bottom:0;
  width:220px;
  background: var(--navy2);
  border-right: 1px solid var(--borde);
  display:flex; flex-direction:column;
  z-index:10;
  animation: slideIn .4s ease;
}
@keyframes slideIn { from{transform:translateX(-20px);opacity:0} to{transform:translateX(0);opacity:1} }

.sidebar-logo {
  padding: 24px 22px 20px;
  border-bottom: 1px solid var(--borde);
}
.sidebar-logo .org {
  font-family: 'DM Serif Display', serif;
  font-size: 17px;
  color: var(--gold);
  line-height: 1.2;
}
.sidebar-logo .modulo {
  font-size: 10px;
  color: var(--txt3);
  letter-spacing: 2px;
  text-transform:uppercase;
  margin-top: 4px;
}

.nav-section {
  padding: 16px 12px 8px;
  font-size: 9px;
  letter-spacing: 2px;
  text-transform:uppercase;
  color: var(--txt3);
  padding-left: 16px;
}
.nav-item {
  display:flex; align-items:center; gap:10px;
  padding: 10px 16px;
  font-size: 13px;
  color: var(--txt2);
  border-radius: 6px;
  margin: 1px 8px;
  cursor:pointer;
  transition: all .2s;
  position:relative;
}
.nav-item:hover { background:rgba(201,168,76,0.08); color:var(--txt); }
.nav-item.active {
  background:rgba(201,168,76,0.12);
  color: var(--gold);
}
.nav-item.active::before {
  content:'';
  position:absolute; left:-8px; top:50%;
  transform:translateY(-50%);
  width:3px; height:20px;
  background: var(--gold);
  border-radius:2px;
}
.nav-icon { font-size:15px; width:20px; text-align:center; }

.badge-alert {
  margin-left:auto;
  background: var(--rojo);
  color:white;
  font-size: 10px;
  font-weight:600;
  padding: 1px 6px;
  border-radius:8px;
}

.sidebar-user {
  margin-top:auto;
  padding: 16px;
  border-top: 1px solid var(--borde);
  display:flex; align-items:center; gap:10px;
}
.user-avatar {
  width:34px; height:34px;
  border-radius:50%;
  background: linear-gradient(135deg, var(--navy3), var(--navy));
  border: 1px solid var(--borde);
  display:flex; align-items:center; justify-content:center;
  font-size:13px; color:var(--gold); font-weight:600;
}
.user-info .name { font-size:12px; font-weight:500; color:var(--txt); }
.user-info .role { font-size:10px; color:var(--txt3); }

/* ─ MAIN ─ */
.main {
  margin-left: 220px;
  padding: 28px 32px;
  position:relative; z-index:1;
  min-height:100vh;
}

/* ─ TOP BAR ─ */
.topbar {
  display:flex; align-items:center; justify-content:space-between;
  margin-bottom: 28px;
  animation: fadeUp .4s .1s both;
}
@keyframes fadeUp { from{transform:translateY(12px);opacity:0} to{transform:translateY(0);opacity:1} }

.topbar-left h1 {
  font-family: 'DM Serif Display', serif;
  font-size: 26px;
  font-weight:400;
  color: var(--txt);
  line-height:1.1;
}
.topbar-left h1 span { color:var(--gold); font-style:italic; }
.topbar-left .subtitle {
  font-size: 12px;
  color: var(--txt3);
  margin-top:4px;
  letter-spacing:.5px;
}

.period-selector {
  display:flex; align-items:center; gap:6px;
  background: var(--navy2);
  border: 1px solid var(--borde);
  border-radius: 8px;
  padding: 4px;
}
.period-btn {
  padding: 6px 14px;
  font-size: 12px;
  font-family:'DM Sans',sans-serif;
  color: var(--txt2);
  background: none;
  border: none;
  border-radius: 6px;
  cursor:pointer;
  transition:all .2s;
  font-weight:500;
}
.period-btn:hover { color:var(--txt); }
.period-btn.active {
  background: rgba(201,168,76,0.15);
  color: var(--gold);
}

/* ─ ALERTAS ─ */
.alert-strip {
  display:flex; gap:12px;
  margin-bottom:24px;
  animation: fadeUp .4s .15s both;
}
.alert-item {
  flex:1;
  background: var(--navy2);
  border: 1px solid;
  border-radius:8px;
  padding: 12px 16px;
  display:flex; align-items:center; gap:12px;
  cursor:pointer;
  transition:transform .2s;
}
.alert-item:hover { transform:translateY(-1px); }
.alert-item.warn { border-color:rgba(232,147,74,0.3); }
.alert-item.danger { border-color:rgba(224,85,85,0.3); }
.alert-item.info { border-color:rgba(74,158,221,0.3); }
.alert-dot { width:8px; height:8px; border-radius:50%; flex-shrink:0; }
.warn .alert-dot { background:var(--naranja); }
.danger .alert-dot { background:var(--rojo); box-shadow:0 0 8px rgba(224,85,85,.4); }
.info .alert-dot { background:var(--azul); }
.alert-txt { font-size:12px; color:var(--txt2); }
.alert-txt strong { color:var(--txt); display:block; font-size:13px; margin-bottom:1px; }

/* ─ KPI GRID ─ */
.kpi-grid {
  display:grid;
  grid-template-columns: repeat(4, 1fr);
  gap:16px;
  margin-bottom:24px;
  animation: fadeUp .4s .2s both;
}

.kpi-card {
  background: var(--card);
  border: 1px solid var(--borde);
  border-radius:10px;
  padding: 20px;
  position:relative;
  overflow:hidden;
  backdrop-filter:blur(10px);
  cursor:default;
  transition:border-color .2s, transform .2s;
}
.kpi-card:hover { border-color:rgba(201,168,76,0.35); transform:translateY(-2px); }
.kpi-card::after {
  content:'';
  position:absolute; top:0; left:0; right:0;
  height:2px;
}
.kpi-card.ing::after  { background:linear-gradient(90deg,var(--verde),transparent); }
.kpi-card.deu::after  { background:linear-gradient(90deg,var(--rojo),transparent); }
.kpi-card.egr::after  { background:linear-gradient(90deg,var(--naranja),transparent); }
.kpi-card.fracc::after { background:linear-gradient(90deg,var(--azul),transparent); }

.kpi-label {
  font-size: 10px;
  letter-spacing:1.5px;
  text-transform:uppercase;
  color:var(--txt3);
  margin-bottom:10px;
}
.kpi-val {
  font-family:'DM Serif Display',serif;
  font-size:30px;
  color:var(--txt);
  line-height:1;
  margin-bottom:8px;
}
.kpi-val .sym { font-size:16px; color:var(--txt3); margin-right:2px; }
.kpi-change {
  font-size:12px;
  display:flex; align-items:center; gap:4px;
}
.kpi-change.up   { color:var(--verde); }
.kpi-change.down { color:var(--rojo); }
.kpi-change.flat { color:var(--txt3); }
.kpi-icon {
  position:absolute; right:16px; top:16px;
  font-size:22px; opacity:.12;
}

/* ─ CONTENIDO PRINCIPAL ─ */
.content-grid {
  display:grid;
  grid-template-columns: 1fr 380px;
  gap:20px;
  margin-bottom:20px;
  animation: fadeUp .4s .25s both;
}

.panel {
  background: var(--card);
  border: 1px solid var(--borde);
  border-radius:10px;
  backdrop-filter:blur(10px);
  overflow:hidden;
}
.panel-header {
  padding:16px 20px;
  border-bottom:1px solid var(--borde);
  display:flex; align-items:center; justify-content:space-between;
}
.panel-header h3 {
  font-size:14px;
  font-weight:500;
  color:var(--txt);
}
.panel-header .ph-sub { font-size:11px; color:var(--txt3); margin-top:1px; }
.panel-body { padding:20px; }
.panel-btn {
  font-size:11px;
  font-family:'DM Sans',sans-serif;
  color:var(--gold);
  background:rgba(201,168,76,0.1);
  border:1px solid rgba(201,168,76,0.2);
  border-radius:5px;
  padding:5px 12px;
  cursor:pointer;
  transition:all .2s;
  font-weight:500;
}
.panel-btn:hover { background:rgba(201,168,76,0.2); }

/* ─ GRÁFICO DE BARRAS (SVG-like con CSS) ─ */
.chart-ingresos {
  height:180px;
  display:flex;
  align-items:flex-end;
  gap:10px;
  padding-bottom:24px;
  position:relative;
}
.chart-ingresos::before {
  content:'';
  position:absolute; left:0; right:0;
  border-top:1px dashed rgba(143,163,184,0.15);
}
.chart-ingresos::after {
  content:'';
  position:absolute; left:0; right:0; bottom:24px;
  border-top:1px dashed rgba(143,163,184,0.1);
}
.bar-group {
  flex:1; display:flex; flex-direction:column;
  align-items:center; gap:4px; position:relative;
}
.bar-wrap {
  width:100%; display:flex; gap:3px;
  align-items:flex-end;
  height:140px;
}
.bar {
  flex:1; border-radius:4px 4px 0 0;
  transition: height .8s cubic-bezier(.34,1.56,.64,1);
  position:relative;
}
.bar.ing-bar  { background:linear-gradient(to top,rgba(46,204,143,.5),rgba(46,204,143,.9)); }
.bar.egr-bar  { background:linear-gradient(to top,rgba(232,147,74,.4),rgba(232,147,74,.7)); }
.bar:hover { filter:brightness(1.3); }
.bar-lbl { font-size:10px; color:var(--txt3); }

/* ─ FUENTES DE INGRESO ─ */
.fuentes-list { display:flex; flex-direction:column; gap:10px; }
.fuente-item {
  display:grid;
  grid-template-columns: 1fr auto auto;
  align-items:center;
  gap:12px;
}
.fuente-name { font-size:13px; color:var(--txt2); }
.fuente-bar-wrap {
  height:6px;
  background:rgba(255,255,255,0.05);
  border-radius:3px;
  overflow:hidden;
  width:80px;
}
.fuente-bar-fill {
  height:100%;
  border-radius:3px;
  transition:width 1s ease;
}
.fuente-monto {
  font-family:'DM Mono',monospace;
  font-size:12px;
  color:var(--txt);
  text-align:right;
  min-width:70px;
}
.fuente-pct { font-size:11px; color:var(--txt3); }

/* ─ FRACCIONAMIENTOS ─ */
.fracc-list { display:flex; flex-direction:column; gap:8px; }
.fracc-item {
  background:rgba(255,255,255,0.03);
  border:1px solid rgba(255,255,255,0.06);
  border-radius:7px;
  padding:12px 14px;
  cursor:pointer;
  transition:all .2s;
}
.fracc-item:hover { border-color:var(--borde); background:rgba(201,168,76,0.04); }
.fracc-item.riesgo { border-color:rgba(224,85,85,0.2); }
.fracc-top {
  display:flex; align-items:center; justify-content:space-between;
  margin-bottom:8px;
}
.fracc-nombre { font-size:13px; font-weight:500; color:var(--txt); }
.fracc-status {
  font-size:10px;
  font-weight:600;
  letter-spacing:1px;
  text-transform:uppercase;
  padding:2px 8px;
  border-radius:4px;
}
.status-ok      { background:rgba(46,204,143,.12); color:var(--verde); }
.status-riesgo  { background:rgba(224,85,85,.12);  color:var(--rojo); }
.status-atencion{ background:rgba(232,147,74,.12); color:var(--naranja); }
.fracc-prog-wrap {
  height:4px; background:rgba(255,255,255,0.06);
  border-radius:2px; overflow:hidden; margin-bottom:6px;
}
.fracc-prog-fill {
  height:100%; border-radius:2px;
  transition: width 1s ease;
}
.fracc-meta {
  display:flex; justify-content:space-between;
  font-size:11px; color:var(--txt3);
}
.fracc-meta .monto { font-family:'DM Mono',monospace; }

/* ─ TABLA DE APROBACIONES ─ */
.bottom-grid {
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:20px;
  animation: fadeUp .4s .3s both;
}
.aprobaciones-list { display:flex; flex-direction:column; gap:8px; }
.apro-item {
  display:grid;
  grid-template-columns: 1fr auto auto;
  align-items:center;
  gap:12px;
  padding:10px 12px;
  background:rgba(255,255,255,0.03);
  border:1px solid rgba(255,255,255,0.06);
  border-radius:7px;
  transition:all .2s;
}
.apro-item:hover { background:rgba(201,168,76,0.04); border-color:var(--borde); }
.apro-left { min-width:0; }
.apro-concepto { font-size:13px; color:var(--txt); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.apro-meta    { font-size:11px; color:var(--txt3); margin-top:1px; }
.apro-monto   { font-family:'DM Mono',monospace; font-size:13px; color:var(--gold); white-space:nowrap; }
.apro-actions { display:flex; gap:5px; }
.btn-apro {
  width:28px; height:28px;
  border-radius:5px;
  border:none;
  cursor:pointer;
  font-size:14px;
  display:flex; align-items:center; justify-content:center;
  transition:all .15s;
}
.btn-ok  { background:rgba(46,204,143,.12);  color:var(--verde); }
.btn-no  { background:rgba(224,85,85,.12);   color:var(--rojo); }
.btn-ok:hover  { background:rgba(46,204,143,.25); transform:scale(1.1); }
.btn-no:hover  { background:rgba(224,85,85,.25);  transform:scale(1.1); }

/* ─ PRESUPUESTO ─ */
.presupuesto-list { display:flex; flex-direction:column; gap:12px; }
.pres-item { }
.pres-header { display:flex; justify-content:space-between; margin-bottom:6px; }
.pres-concepto { font-size:13px; color:var(--txt2); }
.pres-valores  { font-size:11px; color:var(--txt3); font-family:'DM Mono',monospace; }
.pres-bar-wrap {
  height:6px; background:rgba(255,255,255,0.06);
  border-radius:3px; overflow:hidden;
}
.pres-bar-fill {
  height:100%; border-radius:3px;
  transition:width 1.2s ease;
}
.pres-bar-fill.ok       { background:var(--verde); }
.pres-bar-fill.warning  { background:var(--naranja); }
.pres-bar-fill.over     { background:var(--rojo); }
.pres-pct { font-size:11px; margin-top:4px; }
.pct-ok      { color:var(--verde); }
.pct-warning { color:var(--naranja); }
.pct-over    { color:var(--rojo); }

/* ─ NOTIF TOAST ─ */
.toast {
  position:fixed; bottom:24px; right:24px;
  background:var(--navy2);
  border:1px solid var(--borde);
  border-radius:8px;
  padding:14px 18px;
  font-size:13px;
  color:var(--txt);
  box-shadow:0 8px 32px rgba(0,0,0,.4);
  display:flex; align-items:center; gap:10px;
  transform:translateY(80px);
  opacity:0;
  transition:all .3s;
  z-index:100;
}
.toast.show { transform:translateY(0); opacity:1; }
.toast .t-icon { font-size:18px; }

/* ─ SCROLLBAR ─ */
::-webkit-scrollbar { width:6px; }
::-webkit-scrollbar-track { background:var(--navy2); }
::-webkit-scrollbar-thumb { background:var(--navy3); border-radius:3px; }

/* ─ IR A PORTAL COLEGIADO ─ */
.sidebar-switch {
  padding: 10px 12px;
  margin-bottom: 4px;
}
.switch-btn {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  background: rgba(201,168,76,0.07);
  border: 1px solid rgba(201,168,76,0.18);
  border-radius: 8px;
  text-decoration: none;
  cursor: pointer;
  transition: all .2s;
}
.switch-btn:hover {
  background: rgba(201,168,76,0.14);
  border-color: rgba(201,168,76,0.35);
  transform: translateX(2px);
}
.switch-avatar {
  width: 32px; height: 32px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--gold), var(--navy3));
  display: flex; align-items: center; justify-content: center;
  font-size: 12px; font-weight: 700;
  color: var(--navy);
  flex-shrink: 0;
}
.switch-info {
  flex: 1; min-width: 0;
}
.switch-label {
  display: block;
  font-size: 12px;
  font-weight: 500;
  color: var(--gold);
  line-height: 1.2;
}
.switch-mat {
  display: block;
  font-size: 10px;
  color: var(--txt3);
}
.switch-arrow {
  font-size: 13px;
  color: var(--txt3);
  flex-shrink: 0;
}

/* ─ botón hamburguesa ─ */
/* Agregar al <style> */
.sidebar-toggle {
  display: none;
  flex-direction: column;
  gap: 5px;
  background: none;
  border: none;
  cursor: pointer;
  padding: 8px;
  margin-right: 12px;
}
.sidebar-toggle span {
  display: block;
  width: 22px; height: 2px;
  background: var(--txt2);
  border-radius: 2px;
  transition: all .25s;
}
.sidebar-toggle.open span:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
.sidebar-toggle.open span:nth-child(2) { opacity: 0; }
.sidebar-toggle.open span:nth-child(3) { transform: rotate(-45deg) translate(5px, -5px); }

.sidebar-overlay {
  display: none;
  position: fixed; inset: 0;
  background: rgba(0,0,0,.5);
  z-index: 9;
  backdrop-filter: blur(2px);
}

@media (max-width: 768px) {
  .sidebar {
    transform: translateX(-100%);
    transition: transform .3s ease;
  }
  .sidebar.open {
    transform: translateX(0);
  }
  .sidebar-toggle {
    display: flex;
  }
  .sidebar-overlay.open {
    display: block;
  }
  .main {
    margin-left: 0;
  }
  .topbar {
    flex-wrap: wrap;
    gap: 12px;
  }
}

</style>
</head>
<body>

<!-- SIDEBAR -->
<nav class="sidebar">
  <div class="sidebar-logo">
    <div class="org">CCPL</div>
    <div class="modulo">ColegiosPro · Finanzas</div>
  </div>

  <div class="nav-section">Principal</div>
  <div class="nav-item active"><span class="nav-icon">◈</span> Dashboard</div>
  <div class="nav-item"><span class="nav-icon">↗</span> Ingresos</div>
  <div class="nav-item"><span class="nav-icon">↘</span> Egresos</div>
  <div class="nav-item"><span class="nav-icon">⊞</span> Presupuesto</div>

  <div class="nav-section">Gestión</div>
  <div class="nav-item"><span class="nav-icon">⧖</span> Fraccionamientos <span class="badge-alert">3</span></div>
  <div class="nav-item"><span class="nav-icon">◻</span> Por Aprobar <span class="badge-alert">5</span></div>
  <div class="nav-item"><span class="nav-icon">⊙</span> Deuda por Cobrar</div>
  <div class="nav-item"><span class="nav-icon">⊕</span> Otras Fuentes</div>

  <div class="nav-section">Informes</div>
  <div class="nav-item"><span class="nav-icon">▦</span> Reportes PDF</div>
  <div class="nav-item"><span class="nav-icon">⇩</span> Exportar Excel</div>

  <!-- Agregar ANTES del cierre </nav> del sidebar, 
     encima de .sidebar-user -->

     <!--{% if colegiado %} -->
        <div class="sidebar-switch">
        <a href="/dashboard" class="switch-btn" title="Ver mi portal como Colegiado">
            <div class="switch-avatar">
            <!-- Iniciales del directivo, las mismas del login -->
            <!--<span>{{ current_user.initials or 'CO' }}</span> -->
                <span>A.A.</span>
            </div>
            <div class="switch-info">
            <span class="switch-label">Mi portal Colegiado</span>
            <!--<span class="switch-mat">Mat. {{ colegiado.codigo_matricula or '—' }}</span>-->
            <span class="switch-mat">Mat. 10-0637</span>
            </div>
            <span class="switch-arrow">↗</span>
        </a>
        </div>
    <!--{% endif %} -->

  <div class="sidebar-user">
    <div class="user-avatar">DF</div>
    <div class="user-info">
      <div class="name">Dir. Finanzas</div>
      <div class="role">Acceso completo</div>
    </div>
  </div>

</nav>

<!-- MAIN -->
<main class="main">

<!-- TOP BAR -->
<div class="topbar">

  <div style="display:flex; align-items:center; gap:8px;">
    <button class="sidebar-toggle" id="sidebarToggle" onclick="toggleSidebar()">
      <span></span><span></span><span></span>
    </button>
    <div class="topbar-left">
      <h1>Dashboard de <span>Finanzas</span></h1>
      <div class="subtitle">Viernes 21 de Febrero, 2026 · Loreto, Iquitos</div>
    </div>
  </div>

  <div class="period-selector">
    <button class="period-btn" onclick="setPeriod(this,'semana')">Semana</button>
    <button class="period-btn active" onclick="setPeriod(this,'mes')">Este mes</button>
    <button class="period-btn" onclick="setPeriod(this,'trimestre')">Trimestre</button>
    <button class="period-btn" onclick="setPeriod(this,'anio')">Año 2026</button>
    <button class="period-btn" onclick="setPeriod(this,'custom')">Elegir</button>
  </div>

</div>

<!-- Overlay — va FUERA del topbar, directo en <main> -->
<div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

  <!-- ALERTAS -->
  <div class="alert-strip">
    <div class="alert-item danger" onclick="showToast('Redirigiendo a fraccionamientos en riesgo...')">
      <div class="alert-dot"></div>
      <div class="alert-txt">
        <strong>3 fraccionamientos en riesgo</strong>
        2 cuotas impagas consecutivas — requieren atención hoy
      </div>
    </div>
    <div class="alert-item warn" onclick="showToast('Abriendo cola de aprobaciones...')">
      <div class="alert-dot"></div>
      <div class="alert-txt">
        <strong>5 operaciones pendientes de aprobación</strong>
        Condonaciones y ajustes esperan su firma
      </div>
    </div>
    <div class="alert-item info" onclick="showToast('Ver detalle de presupuesto...')">
      <div class="alert-dot"></div>
      <div class="alert-txt">
        <strong>Cuotas Feb 2026 — 68% cobradas</strong>
        S/ 19,040 de S/ 27,880 recaudados al cierre de hoy
      </div>
    </div>
  </div>

  <!-- KPIs -->
  <div class="kpi-grid">
    <div class="kpi-card ing">
      <div class="kpi-icon">↗</div>
      <div class="kpi-label">Ingresos del mes</div>
      <div class="kpi-val"><span class="sym">S/</span><span id="kpi-ing">19,040</span></div>
      <div class="kpi-change up">▲ 12.4% vs enero 2026</div>
    </div>
    <div class="kpi-card deu">
      <div class="kpi-icon">⊙</div>
      <div class="kpi-label">Deuda total pendiente</div>
      <div class="kpi-val"><span class="sym">S/</span><span id="kpi-deu">495,922</span></div>
      <div class="kpi-change down">▼ 3.8% vs mes anterior</div>
    </div>
    <div class="kpi-card egr">
      <div class="kpi-icon">↘</div>
      <div class="kpi-label">Egresos del mes</div>
      <div class="kpi-val"><span class="sym">S/</span><span id="kpi-egr">8,340</span></div>
      <div class="kpi-change flat">▶ 78% del presupuesto</div>
    </div>
    <div class="kpi-card fracc">
      <div class="kpi-icon">⧖</div>
      <div class="kpi-label">Fraccionamientos activos</div>
      <div class="kpi-val"><span id="kpi-fracc">12</span></div>
      <div class="kpi-change down">▲ 3 en riesgo de pérdida</div>
    </div>
  </div>

  <!-- FILA PRINCIPAL -->
  <div class="content-grid">

    <!-- GRÁFICO INGRESOS + FUENTES -->
    <div style="display:flex;flex-direction:column;gap:20px;">

      <div class="panel">
        <div class="panel-header">
          <div>
            <h3>Ingresos vs Egresos</h3>
            <div class="ph-sub">Últimos 6 meses — S/ acumulado</div>
          </div>
          <button class="panel-btn" onclick="showToast('Exportando a PDF...')">Exportar</button>
        </div>
        <div class="panel-body">
          <div style="display:flex;gap:16px;margin-bottom:12px;">
            <div style="display:flex;align-items:center;gap:6px;font-size:12px;color:var(--txt2);">
              <div style="width:10px;height:10px;border-radius:2px;background:rgba(46,204,143,.7)"></div> Ingresos
            </div>
            <div style="display:flex;align-items:center;gap:6px;font-size:12px;color:var(--txt2);">
              <div style="width:10px;height:10px;border-radius:2px;background:rgba(232,147,74,.6)"></div> Egresos
            </div>
          </div>
          <div class="chart-ingresos" id="chart">
            <!-- JS renderiza las barras -->
          </div>
        </div>
      </div>

      <div class="panel">
        <div class="panel-header">
          <div>
            <h3>Fuentes de Ingreso</h3>
            <div class="ph-sub">Distribución febrero 2026</div>
          </div>
          <button class="panel-btn" onclick="showToast('Ver detalle de otras fuentes...')">+ Registrar fuente</button>
        </div>
        <div class="panel-body">
          <div class="fuentes-list" id="fuentes-list"></div>
        </div>
      </div>

    </div>

    <!-- FRACCIONAMIENTOS -->
    <div class="panel" style="display:flex;flex-direction:column;">
      <div class="panel-header">
        <div>
          <h3>Fraccionamientos</h3>
          <div class="ph-sub">12 activos · 3 en riesgo</div>
        </div>
        <button class="panel-btn" onclick="showToast('Ver todos los fraccionamientos...')">Ver todos</button>
      </div>
      <div class="panel-body" style="flex:1;overflow-y:auto;max-height:440px;">
        <div class="fracc-list" id="fracc-list"></div>
      </div>
    </div>

  </div>

  <!-- FILA INFERIOR -->
  <div class="bottom-grid">

    <!-- APROBACIONES -->
    <div class="panel">
      <div class="panel-header">
        <div>
          <h3>Operaciones por Aprobar</h3>
          <div class="ph-sub">Requieren su firma digital</div>
        </div>
        <button class="panel-btn" onclick="showToast('Aprobando todas las operaciones...')">Aprobar todo</button>
      </div>
      <div class="panel-body">
        <div class="aprobaciones-list" id="apro-list"></div>
      </div>
    </div>

    <!-- PRESUPUESTO -->
    <div class="panel">
      <div class="panel-header">
        <div>
          <h3>Ejecución de Presupuesto</h3>
          <div class="ph-sub">Año 2026 — avance mensual</div>
        </div>
        <button class="panel-btn" onclick="showToast('Ver presupuesto completo...')">Detalle</button>
      </div>
      <div class="panel-body">
        <div class="presupuesto-list" id="pres-list"></div>
      </div>
    </div>

  </div>

</main>

<!-- TOAST -->
<div class="toast" id="toast">
  <span class="t-icon">✓</span>
  <span id="toast-msg">Acción ejecutada</span>
</div>

<script>
// ─── DATOS MOCK ───────────────────────────────────────────────────
const MESES = ['Ago','Set','Oct','Nov','Dic','Ene','Feb'];
const DATA = {
  mes: {
    ingresos: [14200, 15800, 13400, 16900, 17200, 16980, 19040],
    egresos:  [7800,  9200,  6500,  8100,  9400,  7600,  8340],
  },
  semana: {
    ingresos: [1200, 2400, 1800, 3100, 2600, 1900, 2040],
    egresos:  [600,  900,  700,  1100, 800,  600,  840],
  },
  trimestre: {
    ingresos: [47000, 52000, 54000, 51000, 56000, 58000, 64000],
    egresos:  [22000, 28000, 24000, 26000, 31000, 24000, 27000],
  },
  anio: {
    ingresos: [14200, 19040, 0, 0, 0, 0, 0],
    egresos:  [7800,  8340,  0, 0, 0, 0, 0],
  }
};

const FUENTES = [
  { nombre: 'Cuotas ordinarias',      monto: 10800, pct: 57, color: '#2ecc8f' },
  { nombre: 'Multas asamblea',        monto: 3200,  pct: 17, color: '#e8934a' },
  { nombre: 'Constancias y derechos', monto: 2140,  pct: 11, color: '#4a9edd' },
  { nombre: 'Cuotas extraordinarias', monto: 1560,  pct:  8, color: '#c9a84c' },
  { nombre: 'Alquiler auditorio',     monto: 840,   pct:  4, color: '#9b7fd4' },
  { nombre: 'Otros ingresos',         monto: 500,   pct:  3, color: '#56728a' },
];

const FRACCIONAMIENTOS = [
  { nombre:'VARGAS SANCHEZ, M.',    cuotas:8,  total:12, saldo:2800, monto_c:350, prox:'15 Mar', estado:'ok' },
  { nombre:'LLONTOP RAMIREZ, C.',   cuotas:3,  total:12, saldo:4900, monto_c:410, prox:'Vencida', estado:'riesgo' },
  { nombre:'PANDURO DEL CASTILLO',  cuotas:5,  total:8,  saldo:1500, monto_c:300, prox:'10 Mar', estado:'ok' },
  { nombre:'RIOS MOZOMBITE, J.',    cuotas:1,  total:12, saldo:6200, monto_c:520, prox:'Vencida', estado:'riesgo' },
  { nombre:'CHUMBE ARAUJO, E.',     cuotas:9,  total:12, saldo:900,  monto_c:300, prox:'28 Feb', estado:'atencion' },
  { nombre:'MORI VILLANUEVA, P.',   cuotas:2,  total:6,  saldo:3600, monto_c:600, prox:'Vencida', estado:'riesgo' },
  { nombre:'FASANANDO GARCIA, R.',  cuotas:6,  total:12, saldo:2100, monto_c:350, prox:'15 Mar', estado:'ok' },
];

const APROBACIONES = [
  { concepto:'Condonación 50% — ARMAS T.',   tipo:'Condonación',   monto:'S/620', solicitante:'Caja' },
  { concepto:'Ajuste monto — GARCIA L.',     tipo:'Rectificación', monto:'S/80',  solicitante:'Admin' },
  { concepto:'Pago parcial — HUANCA M.',     tipo:'Pago',          monto:'S/200', solicitante:'Caja' },
  { concepto:'Exoneración multa — TORRES R.',tipo:'Exoneración',   monto:'S/100', solicitante:'Directiva' },
  { concepto:'Ajuste fraccionamiento',       tipo:'Fraccionamiento',monto:'S/1,200',solicitante:'Caja' },
];

const PRESUPUESTO = [
  { concepto:'Personal y planilla',   ejecutado:4200, total:6000 },
  { concepto:'Servicios básicos',     ejecutado:890,  total:1200 },
  { concepto:'Capacitaciones',        ejecutado:1980, total:2000 },
  { concepto:'Mantenimiento local',   ejecutado:720,  total:800  },
  { concepto:'Eventos institucionales',ejecutado:3100,total:3000 },
  { concepto:'Materiales y útiles',   ejecutado:350,  total:600  },
];

// ─── RENDER GRÁFICO ───────────────────────────────────────────────
function renderChart(key) {
  const d = DATA[key] || DATA.mes;
  const chart = document.getElementById('chart');
  const maxVal = Math.max(...d.ingresos, ...d.egresos);
  chart.innerHTML = '';
  MESES.forEach((mes, i) => {
    const hI = d.ingresos[i] ? Math.round((d.ingresos[i]/maxVal)*130) : 0;
    const hE = d.egresos[i]  ? Math.round((d.egresos[i]/maxVal)*130)  : 0;
    chart.innerHTML += `
      <div class="bar-group">
        <div class="bar-wrap">
          <div class="bar ing-bar" style="height:${hI}px" title="Ingreso: S/${d.ingresos[i]?.toLocaleString()}"></div>
          <div class="bar egr-bar" style="height:${hE}px" title="Egreso: S/${d.egresos[i]?.toLocaleString()}"></div>
        </div>
        <div class="bar-lbl">${mes}</div>
      </div>`;
  });
}

// ─── RENDER FUENTES ───────────────────────────────────────────────
function renderFuentes() {
  document.getElementById('fuentes-list').innerHTML = FUENTES.map(f => `
    <div class="fuente-item">
      <div class="fuente-name">${f.nombre}</div>
      <div class="fuente-bar-wrap">
        <div class="fuente-bar-fill" style="width:${f.pct}%;background:${f.color}"></div>
      </div>
      <div style="display:flex;align-items:center;gap:10px">
        <div class="fuente-monto">S/ ${f.monto.toLocaleString()}</div>
        <div class="fuente-pct">${f.pct}%</div>
      </div>
    </div>`).join('');
}

// ─── RENDER FRACCIONAMIENTOS ──────────────────────────────────────
function renderFracc() {
  document.getElementById('fracc-list').innerHTML = FRACCIONAMIENTOS.map(f => {
    const pct = Math.round((f.cuotas / f.total) * 100);
    const color = f.estado === 'ok' ? '#2ecc8f' : f.estado === 'riesgo' ? '#e05555' : '#e8934a';
    const label = f.estado === 'ok' ? 'Al día' : f.estado === 'riesgo' ? 'En riesgo' : 'Atención';
    return `
    <div class="fracc-item ${f.estado}" onclick="showToast('Ver detalle de ${f.nombre}...')">
      <div class="fracc-top">
        <div class="fracc-nombre">${f.nombre}</div>
        <span class="fracc-status status-${f.estado}">${label}</span>
      </div>
      <div class="fracc-prog-wrap">
        <div class="fracc-prog-fill" style="width:${pct}%;background:${color}"></div>
      </div>
      <div class="fracc-meta">
        <span>${f.cuotas}/${f.total} cuotas · prox: ${f.prox}</span>
        <span class="monto">S/ ${f.saldo.toLocaleString()} saldo</span>
      </div>
    </div>`;
  }).join('');
}

// ─── RENDER APROBACIONES ─────────────────────────────────────────
function renderApro() {
  document.getElementById('apro-list').innerHTML = APROBACIONES.map((a,i) => `
    <div class="apro-item" id="apro-${i}">
      <div class="apro-left">
        <div class="apro-concepto">${a.concepto}</div>
        <div class="apro-meta">${a.tipo} · solicitado por ${a.solicitante}</div>
      </div>
      <div class="apro-monto">${a.monto}</div>
      <div class="apro-actions">
        <button class="btn-apro btn-ok" onclick="aprobar(${i})" title="Aprobar">✓</button>
        <button class="btn-apro btn-no" onclick="rechazar(${i})" title="Rechazar">✕</button>
      </div>
    </div>`).join('');
}

// ─── RENDER PRESUPUESTO ───────────────────────────────────────────
function renderPres() {
  document.getElementById('pres-list').innerHTML = PRESUPUESTO.map(p => {
    const pct = Math.round((p.ejecutado / p.total) * 100);
    const cls = pct > 100 ? 'over' : pct > 85 ? 'warning' : 'ok';
    return `
    <div class="pres-item">
      <div class="pres-header">
        <div class="pres-concepto">${p.concepto}</div>
        <div class="pres-valores">S/${p.ejecutado.toLocaleString()} / S/${p.total.toLocaleString()}</div>
      </div>
      <div class="pres-bar-wrap">
        <div class="pres-bar-fill ${cls}" style="width:${Math.min(pct,100)}%"></div>
      </div>
      <div class="pres-pct pct-${cls}">${pct}% ejecutado${pct>100?' — EXCEDIDO':''}</div>
    </div>`;
  }).join('');
}

// ─── ACCIONES ────────────────────────────────────────────────────
function aprobar(i) {
  document.getElementById(`apro-${i}`).style.opacity = '.3';
  document.getElementById(`apro-${i}`).style.pointerEvents = 'none';
  showToast('✓ Operación aprobada y registrada con su firma');
}
function rechazar(i) {
  document.getElementById(`apro-${i}`).style.opacity = '.3';
  document.getElementById(`apro-${i}`).style.pointerEvents = 'none';
  showToast('✕ Operación rechazada — se notificará al solicitante');
}

function setPeriod(btn, key) {
  document.querySelectorAll('.period-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  if (key === 'custom') { showToast('Selector de fechas — próximamente'); return; }
  renderChart(key);
}

// ─── TOAST ───────────────────────────────────────────────────────
let toastTimer;
function showToast(msg) {
  const t = document.getElementById('toast');
  document.getElementById('toast-msg').textContent = msg;
  t.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => t.classList.remove('show'), 2800);
}

// ─── SIDEBAR TOGGLE ─────────────────────────────────────────────
// Agregar al <script>
function toggleSidebar() {
  const sidebar  = document.querySelector('.sidebar');
  const toggle   = document.getElementById('sidebarToggle');
  const overlay  = document.getElementById('sidebarOverlay');
  const isOpen   = sidebar.classList.toggle('open');
  toggle.classList.toggle('open', isOpen);
  overlay.classList.toggle('open', isOpen);
  document.body.style.overflow = isOpen ? 'hidden' : '';
}

// Cerrar con Escape
document.addEventListener('keydown', e => {
  if (e.key === 'Escape') {
    const sidebar = document.querySelector('.sidebar');
    if (sidebar.classList.contains('open')) toggleSidebar();
  }
});

// ─── INIT ─────────────────────────────────────────────────────────
document.addEventListener('DOMContentLoaded', () => {
  renderChart('mes');
  renderFuentes();
  renderFracc();
  renderApro();
  renderPres();
  // Animar barras del gráfico con delay
  setTimeout(() => {
    document.querySelectorAll('.bar').forEach((b,i) => {
      b.style.animationDelay = `${i*0.04}s`;
    });
  }, 100);
  // Nav items interactivos
  document.querySelectorAll('.nav-item').forEach(item => {
    item.addEventListener('click', function() {
      document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
      this.classList.add('active');
    });
  });
});
</script>
</body>
</html>